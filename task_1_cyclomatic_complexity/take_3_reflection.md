не нашел подходящего для рефакторинга кода на пайтон и вырвал одну из функиций из своего проекта на го.
Полиморфизм тут применить не получится...)))

Но поражает насколько можно лучше писать код если следовать хотя бы одному из правил занятия – пиши без else.