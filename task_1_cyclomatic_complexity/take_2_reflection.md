My script, which I wrote a couple of months ago, I couldn't find much else for refactoring now, and this example doesn't seem to be significantly improvable. Specifically in terms of cyclomatic complexity (CC), it didn't get much better. I managed to eliminate one unnecessary 'else' and handle exceptions more elegantly.

I think the most important practical outcome of this exercise was getting acquainted with python-radon, which I installed in Visual Studio Code. From now on, I will always pay attention to the metrics it collects.